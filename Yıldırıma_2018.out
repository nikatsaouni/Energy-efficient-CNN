2021-12-08 23:05:04.691488: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-08 23:06:27.898793: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-12-08 23:06:27.969597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Quadro RTX 5000 computeCapability: 7.5
coreClock: 1.815GHz coreCount: 48 deviceMemorySize: 15.75GiB deviceMemoryBandwidth: 417.29GiB/s
2021-12-08 23:06:27.969638: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-08 23:06:27.972176: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-08 23:06:27.974330: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-08 23:06:27.975151: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-08 23:06:27.977499: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-08 23:06:27.978775: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-08 23:06:27.982601: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-08 23:06:27.984085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-08 23:06:27.984345: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-12-08 23:06:28.004794: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2100000000 Hz
2021-12-08 23:06:28.009341: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55889afebd00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-12-08 23:06:28.009396: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-12-08 23:06:28.141468: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55886de1c900 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-12-08 23:06:28.141524: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Quadro RTX 5000, Compute Capability 7.5
2021-12-08 23:06:28.143695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: Quadro RTX 5000 computeCapability: 7.5
coreClock: 1.815GHz coreCount: 48 deviceMemorySize: 15.75GiB deviceMemoryBandwidth: 417.29GiB/s
2021-12-08 23:06:28.143765: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-08 23:06:28.143807: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-08 23:06:28.143834: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2021-12-08 23:06:28.143860: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2021-12-08 23:06:28.143885: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2021-12-08 23:06:28.143909: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2021-12-08 23:06:28.143935: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-08 23:06:28.147584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2021-12-08 23:06:28.147648: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2021-12-08 23:06:28.534863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-12-08 23:06:28.534905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2021-12-08 23:06:28.534911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2021-12-08 23:06:28.536520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14904 MB memory) -> physical GPU (device: 0, name: Quadro RTX 5000, pci bus id: 0000:3b:00.0, compute capability: 7.5)
2021-12-08 23:06:30.940154: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2021-12-08 23:06:31.105617: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2021-12-08 23:06:32.325655: W tensorflow/stream_executor/gpu/asm_compiler.cc:81] Running ptxas --version returned 256
2021-12-08 23:06:32.446353: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
Read data
Data loaded
----------------------------------------
----------------------------------------
Define model architecture
Model: "functional_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 14336, 1)]        0         
_________________________________________________________________
Conv_1 (Conv1D)              (None, 4763, 128)         6528      
_________________________________________________________________
batch_normalization (BatchNo (None, 4763, 128)         512       
_________________________________________________________________
Pooling_1 (MaxPooling1D)     (None, 1588, 128)         0         
_________________________________________________________________
Conv_2 (Conv1D)              (None, 1582, 32)          28704     
_________________________________________________________________
batch_normalization_1 (Batch (None, 1582, 32)          128       
_________________________________________________________________
Pooling_2 (MaxPooling1D)     (None, 791, 32)           0         
_________________________________________________________________
Conv_3 (Conv1D)              (None, 782, 32)           10272     
_________________________________________________________________
Conv_4 (Conv1D)              (None, 778, 128)          20608     
_________________________________________________________________
Pooling_3 (MaxPooling1D)     (None, 389, 128)          0         
_________________________________________________________________
Conv_5 (Conv1D)              (None, 375, 256)          491776    
_________________________________________________________________
Pooling_4 (MaxPooling1D)     (None, 187, 256)          0         
_________________________________________________________________
Conv_6 (Conv1D)              (None, 183, 512)          655872    
_________________________________________________________________
Conv_7 (Conv1D)              (None, 181, 128)          196736    
_________________________________________________________________
Flatten1 (Flatten)           (None, 23168)             0         
_________________________________________________________________
dense (Dense)                (None, 512)               11862528  
_________________________________________________________________
dropout (Dropout)            (None, 512)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 1026      
=================================================================
Total params: 13,274,690
Trainable params: 13,274,370
Non-trainable params: 320
_________________________________________________________________
----------------------------------------
Fit model on training data
Epoch 1/50
202/202 - 37s - loss: 0.8142 - accuracy: 0.6210 - val_loss: 0.9006 - val_accuracy: 0.4893
Epoch 2/50
202/202 - 10s - loss: 0.2509 - accuracy: 0.9022 - val_loss: 0.3315 - val_accuracy: 0.8884
Epoch 3/50
202/202 - 10s - loss: 0.1476 - accuracy: 0.9520 - val_loss: 0.1669 - val_accuracy: 0.9330
Epoch 4/50
202/202 - 10s - loss: 0.1014 - accuracy: 0.9666 - val_loss: 0.1228 - val_accuracy: 0.9634
Epoch 5/50
202/202 - 10s - loss: 0.0822 - accuracy: 0.9754 - val_loss: 0.1832 - val_accuracy: 0.9464
Epoch 6/50
202/202 - 10s - loss: 0.0808 - accuracy: 0.9739 - val_loss: 0.1492 - val_accuracy: 0.9634
Epoch 7/50
202/202 - 10s - loss: 0.0652 - accuracy: 0.9797 - val_loss: 0.1152 - val_accuracy: 0.9616
Epoch 8/50
202/202 - 10s - loss: 0.0828 - accuracy: 0.9758 - val_loss: 0.1210 - val_accuracy: 0.9741
Epoch 9/50
202/202 - 10s - loss: 0.0507 - accuracy: 0.9840 - val_loss: 0.1294 - val_accuracy: 0.9679
Epoch 10/50
202/202 - 10s - loss: 0.0455 - accuracy: 0.9845 - val_loss: 0.0776 - val_accuracy: 0.9732
Epoch 11/50
202/202 - 10s - loss: 0.0384 - accuracy: 0.9881 - val_loss: 0.1624 - val_accuracy: 0.9500
Epoch 12/50
202/202 - 10s - loss: 0.0423 - accuracy: 0.9856 - val_loss: 0.0882 - val_accuracy: 0.9741
Epoch 13/50
202/202 - 10s - loss: 0.0468 - accuracy: 0.9858 - val_loss: 0.0978 - val_accuracy: 0.9696
Epoch 14/50
202/202 - 10s - loss: 0.0200 - accuracy: 0.9935 - val_loss: 0.1303 - val_accuracy: 0.9723
Epoch 15/50
202/202 - 10s - loss: 0.0344 - accuracy: 0.9887 - val_loss: 0.1581 - val_accuracy: 0.9634
Epoch 16/50
202/202 - 10s - loss: 0.0176 - accuracy: 0.9937 - val_loss: 0.1783 - val_accuracy: 0.9705
Epoch 17/50
202/202 - 10s - loss: 0.0387 - accuracy: 0.9882 - val_loss: 0.3632 - val_accuracy: 0.9339
Epoch 18/50
202/202 - 10s - loss: 0.0325 - accuracy: 0.9908 - val_loss: 0.1474 - val_accuracy: 0.9598
Epoch 19/50
202/202 - 10s - loss: 0.0219 - accuracy: 0.9933 - val_loss: 0.1396 - val_accuracy: 0.9705
Epoch 20/50
202/202 - 10s - loss: 0.0198 - accuracy: 0.9931 - val_loss: 0.2265 - val_accuracy: 0.9652
Epoch 21/50
202/202 - 10s - loss: 0.0113 - accuracy: 0.9966 - val_loss: 0.1490 - val_accuracy: 0.9714
Epoch 22/50
202/202 - 10s - loss: 0.0185 - accuracy: 0.9946 - val_loss: 0.3825 - val_accuracy: 0.9045
Epoch 23/50
202/202 - 10s - loss: 0.0150 - accuracy: 0.9947 - val_loss: 0.1251 - val_accuracy: 0.9714
Epoch 24/50
202/202 - 10s - loss: 0.0134 - accuracy: 0.9954 - val_loss: 0.1859 - val_accuracy: 0.9705
Epoch 25/50
202/202 - 10s - loss: 0.0317 - accuracy: 0.9923 - val_loss: 0.1636 - val_accuracy: 0.9652
Epoch 26/50
202/202 - 10s - loss: 0.0247 - accuracy: 0.9928 - val_loss: 0.1585 - val_accuracy: 0.9750
Epoch 27/50
202/202 - 10s - loss: 0.0039 - accuracy: 0.9987 - val_loss: 0.2147 - val_accuracy: 0.9786
Epoch 28/50
202/202 - 10s - loss: 6.3145e-04 - accuracy: 0.9999 - val_loss: 0.2419 - val_accuracy: 0.9768
Epoch 29/50
202/202 - 9s - loss: 2.4281e-04 - accuracy: 1.0000 - val_loss: 0.2531 - val_accuracy: 0.9777
Epoch 30/50
202/202 - 10s - loss: 2.6019e-04 - accuracy: 0.9999 - val_loss: 0.2428 - val_accuracy: 0.9714
Epoch 31/50
202/202 - 10s - loss: 1.3361e-04 - accuracy: 1.0000 - val_loss: 0.2726 - val_accuracy: 0.9750
Epoch 32/50
202/202 - 10s - loss: 8.0327e-05 - accuracy: 1.0000 - val_loss: 0.2882 - val_accuracy: 0.9750
Epoch 33/50
202/202 - 10s - loss: 0.0617 - accuracy: 0.9875 - val_loss: 0.1167 - val_accuracy: 0.9634
Epoch 34/50
202/202 - 10s - loss: 0.0323 - accuracy: 0.9899 - val_loss: 0.1116 - val_accuracy: 0.9723
Epoch 35/50
202/202 - 10s - loss: 0.0108 - accuracy: 0.9959 - val_loss: 0.2062 - val_accuracy: 0.9705
Epoch 36/50
202/202 - 10s - loss: 0.0345 - accuracy: 0.9916 - val_loss: 0.1845 - val_accuracy: 0.9580
Epoch 37/50
202/202 - 10s - loss: 0.0132 - accuracy: 0.9955 - val_loss: 0.1588 - val_accuracy: 0.9696
Epoch 38/50
202/202 - 10s - loss: 0.0095 - accuracy: 0.9972 - val_loss: 0.1651 - val_accuracy: 0.9759
Epoch 39/50
202/202 - 10s - loss: 0.0251 - accuracy: 0.9931 - val_loss: 0.1643 - val_accuracy: 0.9580
Epoch 40/50
202/202 - 10s - loss: 0.0130 - accuracy: 0.9966 - val_loss: 0.2105 - val_accuracy: 0.9652
Epoch 41/50
202/202 - 10s - loss: 0.0068 - accuracy: 0.9980 - val_loss: 0.3002 - val_accuracy: 0.9696
Epoch 42/50
202/202 - 10s - loss: 0.0014 - accuracy: 0.9996 - val_loss: 0.2774 - val_accuracy: 0.9652
Epoch 43/50
202/202 - 10s - loss: 0.0021 - accuracy: 0.9998 - val_loss: 0.2470 - val_accuracy: 0.9768
Epoch 44/50
202/202 - 10s - loss: 0.0428 - accuracy: 0.9919 - val_loss: 0.3950 - val_accuracy: 0.9339
Epoch 45/50
202/202 - 10s - loss: 0.0345 - accuracy: 0.9929 - val_loss: 0.1282 - val_accuracy: 0.9705
Epoch 46/50
202/202 - 10s - loss: 0.0055 - accuracy: 0.9984 - val_loss: 0.2734 - val_accuracy: 0.9661
Epoch 47/50
202/202 - 10s - loss: 0.0185 - accuracy: 0.9953 - val_loss: 0.1819 - val_accuracy: 0.9616
Epoch 48/50
202/202 - 10s - loss: 0.0095 - accuracy: 0.9978 - val_loss: 0.1893 - val_accuracy: 0.9741
Epoch 49/50
202/202 - 10s - loss: 0.0062 - accuracy: 0.9981 - val_loss: 0.1696 - val_accuracy: 0.9732
Epoch 50/50
202/202 - 10s - loss: 0.0064 - accuracy: 0.9982 - val_loss: 0.2371 - val_accuracy: 0.9509
350/350 - 4s - loss: 0.0692 - accuracy: 0.9814
WARNING:tensorflow:Callbacks method `on_test_batch_end` is slow compared to the batch time (batch time: 0.0030s vs `on_test_batch_end` time: 0.0067s). Check your callbacks.
150/150 - 1s - loss: 0.3333 - accuracy: 0.9465
---------------------------------------------------
Training evaluation
[0.06915979832410812, 0.9814285635948181]
Test evaluation
[0.33334115147590637, 0.9464583396911621]
---------------------------------------------------
Weights saved to Yidirima.h5 file
